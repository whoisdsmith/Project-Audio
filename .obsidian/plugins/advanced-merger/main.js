/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var u=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var v=Object.getOwnPropertyNames;var N=Object.prototype.hasOwnProperty;var I=(d,r)=>{for(var e in r)u(d,e,{get:r[e],enumerable:!0})},w=(d,r,e,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let t of v(r))!N.call(d,t)&&t!==e&&u(d,t,{get:()=>r[t],enumerable:!(i=y(r,t))||i.enumerable});return d};var D=d=>w(u({},"__esModule",{value:!0}),d);var C={};I(C,{default:()=>c});module.exports=D(C);var s=require("obsidian"),F={de:{MergeFolder:"Ordner zusammenf\xFChren",MergedFilesuffix:"zusammengef\xFChrt",OverwriteFileQuestion:"Vorhandene Datei \xFCberschreiben",Settings:"Einstellungen",SettingSortAlphabetically:"Dateien alphabetisch sortieren",SettingSortAlphabeticallyDescription:"Wenn aktiviert, werden die Dateien im ausgew\xE4hlten Ordner alphabetisch nach ihrem vollst\xE4ndigen Pfad sortiert. Andernfalls werden die Dateien nach dem Erstellungsdatum sortiert (Standardverhalten).",SettingIncludeNestedFolders:"Verschachtelte Ordner einbeziehen",SettingIncludeNestedFoldersDescription:"Wenn aktiviert, werden Dateien in verschachtelten Ordnern zusammengef\xFChrt. Andernfalls werden nur Dateien im ausgew\xE4hlten Ordner zusammengef\xFChrt (Standardverhalten).",SettingIncludeFoldersAsSections:"Ordner als Abschnitte einbeziehen",SettingIncludeFoldersAsSectionsDescription:"Ordner werden als benannte Abschnitte in die Ausgabedatei eingef\xFCgt.",Yes:"Ja",No:"Nein"},en:{MergeFolder:"Merge folder",MergedFilesuffix:"merged",OverwriteFileQuestion:"Overwite exising file",Settings:"Settings",SettingSortAlphabetically:"Sort files alphabetically",SettingSortAlphabeticallyDescription:"If enabled, files in selected folder will be sorted alphabetically, according to its full path. Otherwise, files will be sorted by creation date (default behaviour).",SettingIncludeNestedFolders:"Include nested folders",SettingIncludeNestedFoldersDescription:"If enabled, files in nested folders will be included in merge. Otherwise, only files in selected folder will be merged (default behaviour).",SettingIncludeFoldersAsSections:"Include folders as sections",SettingIncludeFoldersAsSectionsDescription:"Folders will be included as named sections into output file.",Yes:"Yes",No:"No"},fi:{MergeFolder:"Yhdist\xE4 kansio",MergedFilesuffix:"yhdistetty",OverwriteFileQuestion:"Korvaa olemassa oleva tiedosto",Settings:"Asetukset",SettingSortAlphabetically:"Lajittele tiedostot aakkosj\xE4rjestykseen",SettingSortAlphabeticallyDescription:"Jos k\xE4yt\xF6ss\xE4, valitun kansion tiedostot lajitellaan aakkosj\xE4rjestyksess\xE4 sen t\xE4yden polun mukaan. Muussa tapauksessa tiedostot lajitellaan luomisp\xE4iv\xE4m\xE4\xE4r\xE4n mukaan (oletusk\xE4ytt\xE4ytyminen).",SettingIncludeNestedFolders:"Sis\xE4llyt\xE4 sis\xE4kk\xE4iset kansiot",SettingIncludeNestedFoldersDescription:"Jos k\xE4yt\xF6ss\xE4, sis\xE4kk\xE4isten kansioiden tiedostot yhdistet\xE4\xE4n. Muussa tapauksessa vain valitun kansion tiedostot yhdistet\xE4\xE4n (oletustoiminto).",SettingIncludeFoldersAsSections:"Sis\xE4llyt\xE4 kansiot osioihin",SettingIncludeFoldersAsSectionsDescription:"Kansiot sis\xE4llytet\xE4\xE4n nimettyin\xE4 osina tulostiedostoon.",Yes:"Kyll\xE4",No:"Ei"},fr:{MergeFolder:"Fusionner le dossier",MergedFilesuffix:"fusionn\xE9",OverwriteFileQuestion:"Remplacer le fichier existant",Settings:"Param\xE8tres",SettingSortAlphabetically:"Trier les fichiers par ordre alphab\xE9tique",SettingSortAlphabeticallyDescription:"Si activ\xE9, les fichiers du dossier s\xE9lectionn\xE9 seront tri\xE9s par ordre alphab\xE9tique, en fonction de son chemin complet. Sinon, les fichiers seront tri\xE9s par date de cr\xE9ation (comportement par d\xE9faut).",SettingIncludeNestedFolders:"Inclure les dossiers imbriqu\xE9s",SettingIncludeNestedFoldersDescription:"Si activ\xE9, les fichiers des dossiers imbriqu\xE9s seront inclus dans la fusion. Sinon, seuls les fichiers du dossier s\xE9lectionn\xE9 seront fusionn\xE9s (comportement par d\xE9faut).",SettingIncludeFoldersAsSections:"Inclure les dossiers en tant que sections",SettingIncludeFoldersAsSectionsDescription:"Les dossiers seront inclus en tant que sections nomm\xE9es dans le fichier de sortie.",Yes:"Oui",No:"Non"},ru:{MergeFolder:"\u041E\u0431\u044A\u0435\u0434\u0438\u043D\u0438\u0442\u044C \u043F\u0430\u043F\u043A\u0443",MergedFilesuffix:"\u0441\u043E\u0432\u043C\u0435\u0449\u0435\u043D\u043D\u044B\u0439",OverwriteFileQuestion:"\u041F\u0435\u0440\u0435\u0437\u0430\u043F\u0438\u0441\u0430\u0442\u044C \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044E\u0449\u0438\u0439 \u0444\u0430\u0439\u043B",Settings:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438",SettingSortAlphabetically:"\u0421\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0444\u0430\u0439\u043B\u044B \u043F\u043E \u0430\u043B\u0444\u0430\u0432\u0438\u0442\u0443",SettingSortAlphabeticallyDescription:"\u0415\u0441\u043B\u0438 \u0432\u043A\u043B\u044E\u0447\u0435\u043D\u043E, \u0444\u0430\u0439\u043B\u044B \u0432 \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u043E\u0439 \u043F\u0430\u043F\u043A\u0435 \u0431\u0443\u0434\u0443\u0442 \u043E\u0442\u0441\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u044B \u0432 \u0430\u043B\u0444\u0430\u0432\u0438\u0442\u043D\u043E\u043C \u043F\u043E\u0440\u044F\u0434\u043A\u0435 \u0432 \u0441\u043E\u043E\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0438 \u0441 \u043F\u043E\u043B\u043D\u044B\u043C \u043F\u0443\u0442\u0451\u043C. \u0412 \u043F\u0440\u043E\u0442\u0438\u0432\u043D\u043E\u043C \u0441\u043B\u0443\u0447\u0430\u0435, \u0444\u0430\u0439\u043B\u044B \u0431\u0443\u0434\u0443\u0442 \u043E\u0442\u0441\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u044B \u043F\u043E \u0434\u0430\u0442\u0435 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u044F (\u043F\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u0435 \u043F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E).",SettingIncludeNestedFolders:"\u0412\u043B\u044E\u0447\u0430\u0442\u044C \u0432\u043B\u043E\u0436\u0435\u043D\u043D\u044B\u0435 \u043F\u0430\u043F\u043A\u0438",SettingIncludeNestedFoldersDescription:"\u0415\u0441\u043B\u0438 \u0432\u043A\u043B\u044E\u0447\u0435\u043D\u043E, \u0444\u0430\u0439\u043B\u044B \u0432\u043E \u0432\u043B\u043E\u0436\u0435\u043D\u043D\u044B\u0445 \u043F\u0430\u043F\u043A\u0430\u0445 \u0431\u0443\u0434\u0443\u0442 \u0432\u043A\u043B\u044E\u0447\u0435\u043D\u044B \u0432 \u0441\u043B\u0438\u044F\u043D\u0438\u0435. \u0412 \u043F\u0440\u043E\u0442\u0438\u0432\u043D\u043E\u043C \u0441\u043B\u0443\u0447\u0430\u0435 \u0431\u0443\u0434\u0443\u0442 \u043E\u0431\u044A\u0435\u0434\u0438\u043D\u0435\u043D\u044B \u0442\u043E\u043B\u044C\u043A\u043E \u0444\u0430\u0439\u043B\u044B \u0432 \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u043E\u0439 \u043F\u0430\u043F\u043A\u0435 (\u043F\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u0435 \u043F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E).",SettingIncludeFoldersAsSections:"\u0412\u043A\u043B\u044E\u0447\u0430\u0442\u044C \u043F\u0430\u043F\u043A\u0438 \u043A\u0430\u043A \u0440\u0430\u0437\u0434\u0435\u043B\u044B",SettingIncludeFoldersAsSectionsDescription:"\u041F\u0430\u043F\u043A\u0438 \u0431\u0443\u0434\u0443\u0442 \u0432\u043A\u043B\u044E\u0447\u0435\u043D\u044B \u0432 \u0432\u044B\u0445\u043E\u0434\u043D\u043E\u0439 \u0444\u0430\u0439\u043B \u0432 \u043A\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0440\u0430\u0437\u0434\u0435\u043B\u043E\u0432.",Yes:"\u0414\u0430",No:"\u041D\u0435\u0442"},ua:{MergeFolder:"\u041E\u0431'\u0454\u0434\u043D\u0430\u0442\u0438 \u043F\u0430\u043F\u043A\u0443",MergedFilesuffix:"\u043E\u0431'\u0454\u0434\u043D\u0430\u043D\u0456",OverwriteFileQuestion:"\u041F\u0435\u0440\u0435\u0437\u0430\u043F\u0438\u0441\u0430\u0442\u0438 \u0456\u0441\u043D\u0443\u044E\u0447\u0438\u0439 \u0444\u0430\u0439\u043B",Settings:"\u041D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F",SettingSortAlphabetically:"\u0421\u043E\u0440\u0442\u0443\u0432\u0430\u0442\u0438 \u0444\u0430\u0439\u043B\u0438 \u0437\u0430 \u0430\u043B\u0444\u0430\u0432\u0456\u0442\u043E\u043C",SettingSortAlphabeticallyDescription:"\u042F\u043A\u0449\u043E \u0432\u0432\u0456\u043C\u043A\u043D\u0435\u043D\u043E, \u0444\u0430\u0439\u043B\u0438 \u0443 \u0432\u0438\u0431\u0440\u0430\u043D\u0456\u0439 \u043F\u0430\u043F\u0446\u0456 \u0431\u0443\u0434\u0443\u0442\u044C \u0432\u0456\u0434\u0441\u043E\u0440\u0442\u043E\u0432\u0430\u043D\u0456 \u0432 \u0430\u043B\u0444\u0430\u0432\u0456\u0442\u043D\u043E\u043C\u0443 \u043F\u043E\u0440\u044F\u0434\u043A\u0443 \u0432\u0456\u0434\u043F\u043E\u0432\u0456\u0434\u043D\u043E \u0434\u043E \u043F\u043E\u0432\u043D\u043E\u0433\u043E \u0448\u043B\u044F\u0445\u0443. \u0412 \u0456\u043D\u0448\u043E\u043C\u0443 \u0432\u0438\u043F\u0430\u0434\u043A\u0443 \u0444\u0430\u0439\u043B\u0438 \u0431\u0443\u0434\u0443\u0442\u044C \u0432\u0456\u0434\u0441\u043E\u0440\u0442\u043E\u0432\u0430\u043D\u0456 \u0437\u0430 \u0434\u0430\u0442\u043E\u044E \u0441\u0442\u0432\u043E\u0440\u0435\u043D\u043D\u044F (\u043F\u043E\u0432\u0435\u0434\u0456\u043D\u043A\u0430 \u0437\u0430 \u0437\u0430\u043C\u043E\u0432\u0447\u0443\u0432\u0430\u043D\u043D\u044F\u043C).",SettingIncludeNestedFolders:"\u0412\u043A\u043B\u044E\u0447\u0438\u0442\u0438 \u0432\u043A\u043B\u0430\u0434\u0435\u043D\u0456 \u043F\u0430\u043F\u043A\u0438",SettingIncludeNestedFoldersDescription:"\u042F\u043A\u0449\u043E \u0432\u0432\u0456\u043C\u043A\u043D\u0435\u043D\u043E, \u0444\u0430\u0439\u043B\u0438 \u0443 \u0432\u043A\u043B\u0430\u0434\u0435\u043D\u0438\u0445 \u043F\u0430\u043F\u043A\u0430\u0445 \u0431\u0443\u0434\u0443\u0442\u044C \u0432\u043A\u043B\u044E\u0447\u0435\u043D\u0456 \u0432 \u043E\u0431\u2019\u0454\u0434\u043D\u0430\u043D\u043D\u044F. \u0412 \u0456\u043D\u0448\u043E\u043C\u0443 \u0432\u0438\u043F\u0430\u0434\u043A\u0443 \u0431\u0443\u0434\u0435 \u043E\u0431\u2019\u0454\u0434\u043D\u0430\u043D\u043E \u043B\u0438\u0448\u0435 \u0444\u0430\u0439\u043B\u0438 \u0443 \u0432\u0438\u0431\u0440\u0430\u043D\u0456\u0439 \u043F\u0430\u043F\u0446\u0456 (\u043F\u043E\u0432\u0435\u0434\u0456\u043D\u043A\u0430 \u0437\u0430 \u0437\u0430\u043C\u043E\u0432\u0447\u0443\u0432\u0430\u043D\u043D\u044F\u043C).",SettingIncludeFoldersAsSections:"\u0412\u043A\u043B\u044E\u0447\u0438\u0442\u0438 \u043F\u0430\u043F\u043A\u0438 \u044F\u043A \u0440\u043E\u0437\u0434\u0456\u043B\u0438",SettingIncludeFoldersAsSectionsDescription:"\u041F\u0430\u043F\u043A\u0438 \u0431\u0443\u0434\u0443\u0442\u044C \u0432\u043A\u043B\u044E\u0447\u0435\u043D\u0456 \u044F\u043A \u0456\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0456 \u0440\u043E\u0437\u0434\u0456\u043B\u0438 \u0443 \u0432\u0438\u0445\u0456\u0434\u043D\u0438\u0439 \u0444\u0430\u0439\u043B.",Yes:"\u0422\u0430\u043A",No:"\u041D\u0456"}},k={sortAlphabetically:!1,includeNestedFolders:!1,includeFoldersAsSections:!1},T="git-merge",E="Advanced Merger",x="en",M="file-menu",$=`
`,h=`

`,b="#",O="md",c=class extends s.Plugin{async onload(){this.translation=new f,await this.loadSettings(),this.registerEvent(this.app.workspace.on(M,(e,i)=>{if(!(i instanceof s.TFolder))return;let t=i;e.addItem(l=>{l.setTitle(this.translation.get().MergeFolder).setIcon(T).onClick(async a=>await this.onClickCallback(t,a))})})),this.addSettingTab(new p(this.app,this))}async onClickCallback(e,i){let{vault:t}=this.app,l=[];s.Vault.recurseChildren(e,n=>{n instanceof s.TFile&&n.extension==O?(console.log(`Found a file: ${n.name}`),l.push(n)):n instanceof s.TFolder&&this.settings.includeFoldersAsSections&&(console.log(`Found a folder: ${n.name}`),l.push(n))});let a=this.sortNotes(l.filter(n=>this.filterNotes(e,n))),o=`${e.path}-${this.translation.get().MergedFilesuffix}.md`;if(await t.adapter.exists(o,!1)){new S(this.app,this.translation,o,async n=>{if(!n){console.info(`file "${o}" already exists, but user cancelled deleting..`);return}console.info(`file "${o}" already exists, deleting..`),await t.adapter.remove(o),await this.mergeNotes(t,a,o)}).open();return}await this.mergeNotes(t,a,o)}async mergeNotes(e,i,t){let l=await e.create(t,"");for(let a=0;a<i.length;a++){let o=i[a],g=(o.path.match(/\//g)||[]).length,n=`${a===0?"":$}`,m=a===i.length-1;if(o instanceof s.TFile){n+=await e.cachedRead(o);let A=o.name.replace(/\.md$/,"");n=`${b.repeat(g)} ${A}${h}${n}${m?"":h}`,console.info(`Adding file "${o.name}" as section "${A}" into file "${t}"..`)}else o instanceof s.TFolder&&(n+=`${b.repeat(g)} ${o.name}${h}`,console.info(`Adding folder "${o.name}" as section "${n}" into file "${t}"..`));e.append(l,n)}}filterNotes(e,i){var t,l;return this.settings.includeNestedFolders?!!((t=i.parent)!=null&&t.path.startsWith(e.path)):((l=i.parent)==null?void 0:l.path)==e.path}sortNotes(e){return this.settings.sortAlphabetically?e.sort((i,t)=>{let l=i.path.toLowerCase(),a=t.path.toLowerCase();return l<a?-1:l>a?1:0}):e.reverse()}async loadSettings(){this.settings=Object.assign({},k,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}},p=class extends s.PluginSettingTab{constructor(e,i){super(e,i);this.plugin=i}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:`${E} - ${this.plugin.translation.get().Settings}`}),new s.Setting(e).setName(this.plugin.translation.get().SettingSortAlphabetically).setDesc(this.plugin.translation.get().SettingSortAlphabeticallyDescription).addToggle(i=>i.setValue(this.plugin.settings.sortAlphabetically).onChange(async t=>{this.plugin.settings.sortAlphabetically=t,await this.plugin.saveSettings()})),new s.Setting(e).setName(this.plugin.translation.get().SettingIncludeNestedFolders).setDesc(this.plugin.translation.get().SettingIncludeNestedFoldersDescription).addToggle(i=>i.setValue(this.plugin.settings.includeNestedFolders).onChange(async t=>{this.plugin.settings.includeNestedFolders=t,this.plugin.settings.includeFoldersAsSections=t===!1?t:this.plugin.settings.includeFoldersAsSections,await this.plugin.saveSettings(),this.showIncludeFolderAsSectionSetting(e)})),this.showIncludeFolderAsSectionSetting(e)}showIncludeFolderAsSectionSetting(e){var i,t;if(!this.plugin.settings.includeNestedFolders){(t=(i=this.includeFolderAsSectionSetting)==null?void 0:i.settingEl)==null||t.remove();return}this.includeFolderAsSectionSetting=new s.Setting(e).setName(this.plugin.translation.get().SettingIncludeFoldersAsSections).setDesc(this.plugin.translation.get().SettingIncludeFoldersAsSectionsDescription).addToggle(l=>l.setValue(this.plugin.settings.includeFoldersAsSections).onChange(async a=>{this.plugin.settings.includeFoldersAsSections=a,await this.plugin.saveSettings()}))}},S=class extends s.Modal{constructor(e,i,t,l){super(e);this.tranlation=i,this.existingFileName=t,this.onSubmitHandler=l}onOpen(){let{contentEl:e}=this;e.createEl("h3",{text:`${this.tranlation.get().OverwriteFileQuestion} "${this.existingFileName}"?`}),new s.Setting(e).addButton(i=>i.setButtonText(this.tranlation.get().No).setCta().onClick(()=>{this.close(),this.onSubmitHandler(!1)})).addButton(i=>i.setButtonText(this.tranlation.get().Yes).setCta().onClick(()=>{this.close(),this.onSubmitHandler(!0)}))}onClose(){let{contentEl:e}=this;e.empty()}},f=class{constructor(){this.language=Object.keys(F).contains(navigator.language)?navigator.language:x}get(){return F[this.language]}};
